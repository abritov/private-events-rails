<p style="color: green"><%= notice %></p>

<% content_for :title, "Events" %>

<div class="events-container">
  <div class="events-header">
    <h1>Events</h1>

    <% if user_signed_in? %>
      <%= link_to new_event_path, class: 'btn btn-primary new-event-btn' do %>
        <span class="btn-icon">+</span> New Event
      <% end %>
    <% end %>
  </div>

  <div class="events-grid">
    <% @events.each do |event| %>
      <div class="event-card">
        <div class="event-header">
          <h3 class="event-title"><%= event.title %></h3>
          <span class="event-date"><%= event.date.strftime('%b %d, %Y') %></span>
        </div>

        <div class="event-details">
          <p class="event-description"><%= truncate(event.description, length: 120) %></p>

          <div class="event-meta">
            <div class="meta-item">
              <span class="meta-icon">📍</span>
              <span class="meta-text"><%= event.location %></span>
            </div>

            <div class="meta-item">
              <span class="meta-icon">👤</span>
              <span class="meta-text"><%= event.user.email %></span>
            </div>

            <div class="meta-item">
              <span class="meta-icon">👥</span>
              <span class="meta-text"><%= pluralize(event.attendees.count, 'attendee') %></span>
            </div>
          </div>
        </div>

        <div class="event-actions">
          <%= link_to 'View Details', event, class: 'btn btn-outline' %>

          <% if user_signed_in? && event.user == current_user %>
            <div class="owner-actions">
              <%= link_to 'Edit', edit_event_path(event), class: 'btn btn-edit' %>
              <%= link_to 'Delete', event, method: :delete, data: { confirm: 'Are you sure you want to delete this event?' }, class: 'btn btn-delete' %>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>

  <% if @events.empty? %>
    <div class="empty-state">
      <div class="empty-icon">📅</div>
      <h3>No Events Yet</h3>
      <p>Be the first to create an event!</p>
      <% if user_signed_in? %>
        <%= link_to 'Create Your First Event', new_event_path, class: 'btn btn-primary' %>
      <% else %>
        <%= link_to 'Sign in to Create Events', new_user_session_path, class: 'btn btn-primary' %>
      <% end %>
    </div>
  <% end %>
</div>
